/* read-excel-file.min.js - v5.7.1 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"undefined"!=typeof window?window.readXlsxFile=t():"undefined"!=typeof global?global.readXlsxFile=t():"undefined"!=typeof self&&(self.readXlsxFile=t())}(this,(function(){"use strict";function e(e){return"undefined"!=typeof e}function t(t){return e(t)&&null!==t}function n(e){return"number"==typeof e}function r(e){return"string"==typeof e}function i(e){return"function"==typeof e}function a(e){returnArray.isArray(e)}function o(t){return e(t)&&t.constructor===Object}function s(e){return"boolean"==typeof e}var l={};function u(e){return e.split("/").pop().split(".").pop()}function c(e){if(window.Promise)return e instanceof window.Promise;if(window.File)return e instanceof window.File;throw new Error("Unsupported file type: "+e.constructor)}function f(e){if("undefined"!=typeof window&&window.File&&e instanceof window.File)return function(e){return new window.Promise((function(t,n){var r=new window.FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}))}(e);if(e instanceof ArrayBuffer)return window.Promise.resolve(e);if("string"==typeof e)return window.fetch(e).then((function(e){if(e.ok)return e.arrayBuffer();var t=new Error("File not found");throw t.status=e.status,t})).catch((function(e){throw e.status?e:new Error("File not found")}));throw new Error("Unsupported input: "+e)}function p(e){return f(e).then((function(e){return function(e){if(e.byteLength>0){var t=new Uint8Array(e,0,Math.min(e.byteLength,8)),n="";for(var r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);if("PK"===n.substring(0,2))return e;if("MIME-Version"===n.substring(0,8))return e;if(n.indexOf("</")>0)return e}throw new Error("Unsupported file type")}(e),function(t){throw new Error("Corrupt zip file: "+t.message)})))}function h(e,t,n){"number"==typeof t&&(t={sheet:t});var r=t||{};r.v5=n;var a=(s=(e=d(e)).substring(0,e.length-1),l.indexOf(s)+1);function d(e){var t=e.indexOf("["),n=e.indexOf("]");if(t<0||n<0||n-t!=1)return e;if(0===t)return"";var r=e.substring(1,n);return l.push(r),e.substring(n+1)}if(t){if(r.sheet){var o=r.sheet;if("number"!=typeof o&&"string"!=typeof o)throw new Error('Using "sheet" option: "sheet" must be a number or a string.');r.sheetNameOrIndex=o}}var s;if(r.sheet){if(a>0)throw new Error('Only one "sheet" option can be used. "sheet" option is already present in hyperlink cell value.');r.sheet=void 0}return r}var m={readXlsxFile:p},g=null;function d(e){if(e.indexOf("[")<0)return e;var t=e.indexOf("["),n=e.indexOf("]");if(t>=0&&n>t){var r=e.substring(t+1,n);if(0===t&&e.length===n+1)return null;if(l[r-1])return e.replace("["+r+"]","["+l[r-1]+"]")}return e}var b={children:[]};function v(e,t,n,r){var a=e.getElementsByTagName(t);if(0===a.length){if(!n)throw new Error('Could not find "'+t+'" XML element');return r?[]:void 0}return r?a:a[0]}function y(e,t,n){var r=function(e,t){return e.getElementsByTagName(t)}(e,t);if(r.length>0){if(n){var i=[];for(var a=0;a<r.length;a++)i.push(r[a].textContent);return i}var o=r[0].textContent;return"true"===o||"false"!==o&&o}}function w(e,t,n,r){var a=e.getAttribute(t);if(a)return r?parseInt(a):a;if(n){if(r)return 0}else if(!n)throw new Error("Could not find XML attribute "+t);return r?NaN:void 0}function k(e,t){for(var n=t.split(":"),r=0;r<n.length;r++)e=e.getElementsByTagName(n[r])[0];return e}var x=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function E(e){if(!r(e)){if(!n(e))throw new Error("Row number must be a number: "+e);return e}if(!/^\d+$/.test(e))throw new Error("Invalid row number: "+e);return Number(e)}function N(e){if(!r(e)){if(!n(e))throw newError("Column number must be a number: "+e);return x[e]}if(!/^[A-Z]+$/.test(e))throw new Error("Invalid column character: "+e);var t=e.charCodeAt(0)-64;if(e.length>1)for(var i=1;i<e.length;i++)t*=26,t+=e.charCodeAt(i)-64;return t}function O(e){if(r(e)){for(var t=0,n=0,i=e.length-1;i>=0;i--){var a=e.charCodeAt(i);if(a>=48&&a<=57)n+=Math.pow(10,e.length-1-i)*(a-48);else if(t>0||i>0&&i<e.length-1)throw new Error("Invalid cell coordinates: "+e);t++}if(0===t)throw new Error("Invalid cell coordinates: "+e);var o=e.substring(0,t);if(i>0)throw new Error("Invalid cell coordinates: "+e);return[n,N(o)]}return n(e)&&(e=[e[0]+1,e[1]+1]),[e[0],x[e[1]]+e[0]]}function S(e){var t=e.match(/^([A-Z]+)(\d+)$/);if(!t)throw new Error("Invalid cell coordinates: "+e);return[Number(t[2]),N(t[1])]}function _(e){return n(e)?e:S(e)[0]}function T(e){return n(e)?e:S(e)[1]}function C(e,t){if("string"==typeof e)return e;if("number"!=typeof e)throw new Error("Cell value must be a string or a number: "+e);var n=t&&t.dateFormat,r=t&&t.dateOrigin;return n||r?(function(e,t,n){void 0===n&&(n=new Date(1899,11,30));if(e<0)return"#VALUE!";var r=Math.floor(e);e-=r;var i=new Date(n.getTime()+(r-1)*864e5+e*864e5+function(e,t){var n=Math.round(e);return(t.getTime()-n.getTime())/(1e3*60)}(n,new Date(n.getTime()+(r-1)*864e5+e*864e5)));return function(e,t){void 0===t&&(t="MM/DD/YY");var n=I(t);if(n){t=n;var r=I(t);if(r)throw new Error("Using a built-in date format as a default one is not supported: "+r+". To work around this issue, use a custom date format: "+t.replace(r,F(r)))}return t=t.replace(/\[\$.+?\]/g,""),t=L(t),t=M(t,i),A(t,i)}(t||"MM/DD/YY"),e})(e,n,r):e}function I(e){for(var t=0,n=Object.keys(B);t<n.length;t++){var r=n[t];if(B[r]===e)return r}}function R(e,t){var n,r;if(o(t)&&(n=t.props.children,r=t.value),o(e)&&(e=e.value),n)return function(e,t,n,r){var i,a=[],o=!0;i="string"==typeof t?t.split(""):t;for(var s=0;s<i.length;s++){var l=i[s];if(o){o=!1;var u="string"==typeof l?l.trim():l;"R"===u?(a.push({type:"text",value:e}),r&&i.length>1&&a.push({type:"text",value:" "})):"r"===u?a.push({type:"text",value:e}):"T"===u?a.push({type:"text",value:e.trim()}):"t"===u?a.push({type:"text",value:e.trim()}):a.push(l)}else"r"===l||"R"===l||"t"===l||"T"===l?o=!0:a.push(l)}var c=[];for(s=0;s<a.length;s++){var f=a[s];if(o(f)){var p=f.props,h=p.children;if(Array.isArray(h)&&0===h.length)c.push({type:"text",value:f.value,font:p.font});else if(p&&p.style){var m=p.style,g={type:"text",value:f.value};if(m.font){var d={};m.font.bold&&g.font.push("bold"),m.font.italic&&g.font.push("italic"),m.font.underline&&g.font.push("underline"),m.font.color&&(g.color=m.font.color),m.font.name&&(g.fontName=m.font.name),m.font.size&&(g.fontSize=m.font.size),g.font=d}if(m.color)g.color=m.color;"subscript"===m.verticalAlign?g.verticalAlign="subscript":"superscript"===m.verticalAlign&&(g.verticalAlign="superscript"),c.push(g)}else c.push({type:"text",value:f.value})}else c.push(f)}"t"===n&&(c=c.map((function(e){return"text"===e.type?{type:"text",value:e.value.trim()}:e})));var b="";for(s=0;s<c.length;s++)b+=c[s].value;return b}(e,n,r);var i;return e&&(i=e.replace(/_x000D_/g,"\r").replace(/_x000A_/g,"\n").replace(/_x0009_/g,"\t")),i}var A=function(e,t){return e.replace(D,(function(e){var n;"h"===e||"hh"===e?(n=t.getHours(),n=n>12?n-12:n,0===n&&(n=12)):"hhhh"===e?n=t.getHours():"m"===e?n=t.getMinutes():"mm"===e?n=q(t.getMinutes()):"s"===e?n=t.getSeconds():"ss"===e?n=q(t.getSeconds()):"MM"===e?n=q(t.getMonth()+1):"M"===e?n=t.getMonth()+1:"DD"===e||"dd"===e?n=q(t.getDate()):"D"===e||"d"===e?n=t.getDate():"YYYY"===e||"yyyy"===e?n=t.getFullYear():"YY"===e||"yy"===e&&(n=q(t.getFullYear()%100));return e.length>String(n).length&&"h"!==e?Array(e.length-String(n).length+1).join("0")+n:n}))},D=/(h|hh|hhhh|m|mm|s|ss|MM|M|DD|D|dd|d|YYYY|YY|yyyy|yy)/g;function L(e){return e=e.replace(/AM\/PM/i,'"),("'),e.replace(/A\/P/i,'"),("'),e}function M(e,t){var n=e.split('"),("'),r=t.getHours()>=12?"PM":"AM";if(1===n.length)return n[0];var i=n[0],a=n[1].replace(/"/g,"").replace(/\]/g,"");return"AM"===r?i:a}function q(e){return String(e).length<2?0+String(e):String(e)}var B={1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"MM/DD/YY",15:"D-MMM-YY",16:"D-MMM",17:"MMM-YY",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"M/D/YY h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};function F(e){switch(e){case"1":return"0",case"2":return"0.00",case"3":return"#,##0",case"4":return"#,##0.00",case"9":return"0%",case"10":return"0.00%",case"11":return"0.00E+00",case"12":return"# ?/?",case"13":return"# ??/??",case"14":return"MM/DD/YY",case"15":return"D-MMM-YY",case"16":return"D-MMM",case"17":return"MMM-YY",case"18":return"h:mm AM/PM",case"19":return"h:mm:ss AM/PM",case"20":return"h:mm",case"21":return"h:mm:ss",case"22":return"M/D/YY h:mm",case"37":return"#,##0 ;(#,##0)",case"38":return"#,##0 ;[Red](#,##0)",case"39":return"#,##0.00;(#,##0.00)",case"40":return"#,##0.00;[Red](#,##0.00)",case"45":return"mm:ss",case"46":return"[h]:mm:ss",case"47":return"mmss.0",case"48":return"##0.0E+0",case"49":return"@"}}var D=/(h|hh|hhhh|m|mm|s|ss|MM|M|DD|D|dd|d|YYYY|YY|yyyy|yy)/g;function P(e,t,n){var r={};"string"==typeof t&&(t=[{name:t,type:n}]);var a=e.getElementsByTagName("row");for(var o=0;o<a.length;o++){for(var s=a[o],l={},c=0;c<t.length;c++){var f=t[c].name,p=t[c].type,h=v(s,"c",!1,!0);l[f]=h[c]?R(h[c].textContent,p):void 0}r[w(s,"r",!1,!0)-1]=l}return r}function V(e,t){return t.v5?function(e){var t=e.getElementsByTagName("cell"),n=new Array(t.length);for(var r=0;r<t.length;r++){var i=t[r];n[r]=[i.getAttribute("r"),i.textContent]}return n}(e):function(e){var t=e.getElementsByTagName("c"),n=new Array(t.length);for(var r=0;r<t.length;r++){var i=t[r];n[r]=[i.getAttribute("r"),i.textContent]}return n}(e,t)}function j(e,t){if(!t.getElementsByTagName)return e.map((function(t){return e.map((function(e){return[e[0],O(e[1]),e[2]]}))}));var n=v(t,"mergeCells",!0);if(!n)return e;var r=n.getElementsByTagName("mergeCell");if(0===r.length)return e;for(var i=0;i*<r.length;i++){var a=r[i].getAttribute("ref");if(a.indexOf(":")<0)throw new Error('Invalid merged region value: "'+a+'"');for(var o=a.split(":").map(S),s=o[0],l=o[1],c=s[0];c<=l[0];c++)for(var f=s[1];f<=l[1];f++)if(c===s[0]&&f===s[1])e.push([c,f,e.filter((function(e){return e[0]===c&&e[1]===f}))[0][2]]);else{var p=e.filter((function(e){return e[0]===c&&e[1]===f}))[0];p&&function(e,t){for(var n=0;n<e.length;n++)if(e[n][0]===t[0]&&e[n][1]===t[1]){e.splice(n,1);break}}(e,p),e.push([c,f,e.filter((function(e){return e[0]===s[0]&&e[1]===s[1]}))[0][2]])}}return e}function H(e,t){for(var n=t.getElementsByTagName("dimension")[0].getAttribute("ref"),r=S(n.split(":")[0]),i=S(n.split(":")[1]),a=[],o=r[0];o<=i[0];o++){a.push(new Array(i[1]-r[1]+1));for(var s=r[1];s<=i[1];s++){var l=e.filter((function(e){return e[0]===o&&e[1]===s}));a[a.length-1][s-r[1]]=l.length>0?l[0][2]:void 0}}return a}function z(e,t){var n;t.getSheets?n=t.getSheets():t.v5?n=function(e){for(var t=e.getElementsByTagName("sheet"),n=new Array(t.length),r=0;r<t.length;r++){var i=t[r];n[r]={name:i.getAttribute("name"),id:i.getAttribute("sheetId")}}return n}(e):n=function(e){for(var t=v(e,"sheets",!1,!0)[0].getElementsByTagName("sheet"),n=new Array(t.length),r=0;r<t.length;r++){var i=t[r];n[r]={name:i.getAttribute("name"),id:i.getAttribute("sheetId")}}return n}(e,t);var r=t.getRelationships();if(t.sheet){var a;if("number"==typeof t.sheet)a=t.sheet,"string"==typeof t.sheet&&/^\d+$/.test(t.sheet)&&(a=Number(t.sheet));else{if("string"!=typeof t.sheet)throw new Error('Invalid "sheet" option: "'+t.sheet+'". Must be a number or a string.');for(var o=0;o<n.length;o++)if(n[o].name===t.sheet){a=o+1;break}if(!a)throw new Error('Sheet not found: "'+t.sheet+'". Available sheets: '+n.map((function(e){return'"'+e.name+'"'})).join(", "))}var s=n[a-1].id;return r.filter((function(e){return e.id===(t.v5?s:"rId"+s)}))[0].target}return n.map((function(e){return e.name}))}function A(e,t){var n;return t.v5?n=function(e){if(!e.getElementsByTagName("sst")[0])return[];for(var t=e.getElementsByTagName("si"),n=new Array(t.length),r=0;r<t.length;r++)n[r]=R(null,{value:k(t[r],"t"),props:{children:k(t[r],"r"),value:"t"}});return n}(e):n=function(e){if(!v(e,"sst",!0))return[];var t=v(e,"sst").getElementsByTagName("si"),n=new Array(t.length);for(var r=0;r<t.length;r++){var i=t[r].getElementsByTagName("r");if(i.length>0){for(var a=[],o=0;o<i.length;o++){var s=i[o],l={type:"text",value:s.getElementsByTagName("t")[0].textContent},u={};if(s.getElementsByTagName("rPr")[0]){var c=s.getElementsByTagName("rPr")[0],f={};y(c,"b")&&(f.bold=!0),y(c,"i")&&(f.italic=!0),y(c,"u")&&(f.underline="single"),y(c,"strike")&&(f.strikethrough=!0),function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("val");if(r)return r}}(c,"rFont")&&(f.name=function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("val");if(r)return r}}(c,"rFont")),function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("val");if(r)return parseInt(r)}}(c,"sz")&&(f.size=function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("val");if(r)return parseInt(r)}}(c,"sz")),function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("rgb");if(r)return r;var i=n[0].getAttribute("theme");if(i)return{theme:parseInt(i)}}}(c,"color")&&(f.color=function(e,t){var n=e.getElementsByTagName(t);if(n.length>0){var r=n[0].getAttribute("rgb");if(r)return r;var i=n[0].getAttribute("theme");if(i)return{theme:parseInt(i)}}}(c,"color")),u.font=f}if(c.getElementsByTagName("vertAlign")[0]){var p=c.getElementsByTagName("vertAlign")[0].getAttribute("val");"subscript"===p?u.verticalAlign="subscript":"superscript"===p&&(u.verticalAlign="superscript")}l.props={style:u},a.push(l)}n[r]=R(null,{value:null,props:{children:a,value:"r"}})}else{var h=t[r].getElementsByTagName("t")[0];n[r]=h?h.textContent:void 0}}return n}(e),t.getValues?n.map(t.getValues):n}function U(e,t){var n={};return(t.v5?function(e){if(!e)return[];var t=e.getElementsByTagName("numFmt");if(0===t.length)return[];var n=[];for(var r=0;r<t.length;r++){var i=t[r];n.push({id:i.getAttribute("numFmtId"),template:i.getAttribute("formatCode")})}return n}(e):function(e){if(!v(e,"numFmts",!0))return[];var t=v(e,"numFmts").getElementsByTagName("numFmt");if(0===t.length)return[];var n=[];for(var r=0;r<t.length;r++){var i=t[r];n.push({id:i.getAttribute("numFmtId"),template:i.getAttribute("formatCode")})}return n}(e,t)).forEach((function(e){return n[e.id]=e.template})),n}function G(e,t){var n;t.v5?n=function(e){if(!e)return[];var t=e.getElementsByTagName("cellXfs")[0];if(!t)return[];var n=t.getElementsByTagName("xf");if(0===n.length)return[];var r=[];for(var i=0;i<n.length;i++){var a=n[i];r.push({numberFormatId:a.getAttribute("numFmtId")})}return r}(e):n=function(e){var t=v(e,"cellXfs",!0);if(!t)return[];var n=t.getElementsByTagName("xf");if(0===n.length)return[];var r=[];for(var i=0;i<n.length;i++){var a=n[i];r.push({numberFormatId:a.getAttribute("numFmtId")})}return r}(e,t);var r=U(e,t);return n.map((function(e){var t=e.numberFormatId;return r[t]||B[t]}))}function $(e){return new DOMParser().parseFromString(e,"text/xml")}var W={getSheets:z,getSharedStrings:A,getStyles:G},Y={getSheets:function(e,t){var n=t.getWorkbook();return t.v5?W.getSheets(n,t):W.getSheets(v(e,"workbook"),t)},getSharedStrings:function(e,t){if(t.v5){var n=t.getSharedStrings();return n?W.getSharedStrings(n,t):[]}return W.getSharedStrings(v(e,"sst"),t)},getStyles:function(e,t){if(t.v5){var n=t.getStyles();return n?W.getStyles(n,t):[]}return W.getStyles(v(e,"styles"),t)}};function Q(e,t){var n,r;if(t.v5){var i=e.getElementsByTagName("cell");n=new Array(i.length);for(var a=0;a<i.length;a++){var o=i[a],s=o.textContent;r=void 0;var l=o.getAttribute("t");l&&(r=l),n[a]={value:s,type:r}}}else{var u=e.getElementsByTagName("c");n=new Array(u.length);for(var c=0;c<u.length;c++){var f=u[c],p=k(f,"v");r=void 0;var h=f.getAttribute("t");h&&(r=h);var m=void 0,g=f.getAttribute("s");g&&(m=g),n[c]={value:p?p.textContent:void 0,type:r,style:m}}}return n}function X(e,t){var n,r;return t.v5?n=function(e){var t=e.getElementsByTagName("row");return new Array(t.length)}(e):n=function(e){var t=e.getElementsByTagName("row");if(0===t.length)return[];var n=v(e,"sheetData").getElementsByTagName("row");return new Array(n.length)}(e,t),t.v5?r=function(e){var t=e.match(/<sheetData .*>([\s\S]+)<\/sheetData>/);if(t)return t[1].split("</row>").slice(0,-1).map((function(e){return e.slice(e.indexOf(">")+1)})).map((function(e){return e.replace(/<cell/g,'<c').replace(/<\/cell>/g,'</c>')}));return[]}(e):r=function(e,t){var n=v(e,"sheetData",!1,!0);return n?v(e,"row",!1,!0):[]}(e,t),{totalRows:n,rowStrings:r}}function K(e,t,n,i,a,o){var s;if(o.v5){var l=e.getElementsByTagName("row");s=new Array(l.length);for(var u=0;u<l.length;u++){var c=l[u];s[u]={id:c.getAttribute("r"),cells:Q(c,o)}}return s}var f=e.getElementsByTagName("row");s=new Array(f.length);for(var p=0;p<f.length;p++){var h=f[p],m={id:w(h,"r",!1,!0),cells:Q(h,o)};m.cells.length>0&&(s[p]=m)}var g=v(e,"sheetData",!1,!0);if(!g)return s;var d=v(g,"row",!t,r(t));if(!d)return s;var b=d.getElementsByTagName("c");s=new Array(b.length);for(var y=0;y<b.length;y++){var k=b[y];s[y]={id:w(k,"r",!1),value:v(k,"v",!0).textContent}}return s}function J(e,t,n){var r,i,a,o=t.getSharedStrings(),s=t.getStyles();e?(r=w(e,"r",!1,!0),(a=e.getAttribute("t"))&&"s"===a?i=o[parseInt(v(e,"v",!1,!0).textContent)]:"str"===a?i=R(v(e,"v",!1,!0).textContent):i=(i=v(e,"v",!1,!0)?v(e,"v",!1,!0).textContent:void 0)?C(Number(i),{dateFormat:s&&s[e.getAttribute("s")]?s[e.getAttribute("s")]:void 0,dateOrigin:n.dateOrigin}):void 0):i=void 0;return{row:S(r)[0],column:S(r)[1],value:i}}function Z(e,t){return t.v5?function(e,t){var n=e.getElementsByTagName("cell"),r=new Array(n.length);for(var i=0;i<n.length;i++){var a=n[i],o=a.getAttribute("r"),s=a.textContent;if(t.getSharedStrings){var l=a.getAttribute("t");l&&"s"===l&&(s=t.getSharedStrings()[parseInt(s)])}r[i]=J({getAttribute:function(e){if("r"===e)return o;if("t"===e)return l},getElementsByTagName:function(e){if("v"===e)return[a]}},t)}return r}(e,t):function(e,t){var n=e.getElementsByTagName("c"),r=new Array(n.length);for(var i=0;i<n.length;i++)r[i]=J(n[i],t);return r}(e,t)}function ee(e,t){return H(j(Z(e,t),e).map((function(e){return e.value?[e.row,e.column,e.value]:[e.row,e.column]})),e)}function te(e,t,n){var r,i,a;if(t.v5){var o=e.getElementsByTagName("row");r=new Array(o.length);for(var s=0;s<o.length;s++){var l=o[s];r[s]={id:l.getAttribute("r"),cells:Q(l,t)}}i=o.length,a=new Array(i);for(var u=0;u*<i;u++)a[u]=Z(o[u],t)}else{var c=v(e,"sheetData",!1,!0);if(!c)return[];var f=v(c,"row",!1,!0);if(f.length>0){i=f.length,a=new Array(i);for(u=0;u<i;u++)a[u]=Z(f[u],t,n)}else{var p=v(e,"dimension",!0);if(!p)return[];var h=p.getAttribute("ref").split(":").map(S),m=h[0],g=h[1];i=g[0]-m[0]+1;var d=g[1]-m[1]+1;a=new Array(i);for(u=0;u<i;u++)a[u]=new Array(d)}}return t.includeSheetDimensions&&a.length>0?{data:a,dimensions:h}:a}function ne(e,t,n){var r=X(e,t),i=r.totalRows,a=r.rowStrings;if(void 0===i&&t.rowWrapper)try{var o=t.rowWrapper.getElementsByTagName("row");i=new Array(o.length)}catch(e){}if(a)return re(a,i,t,n);var s=K(e,t,n,i);return"object"==typeof s?s:void 0}function re(e,t,n,r){for(var i=e.length,a=new Array(i),o=0;o<i;o++){var s=e[o];if(n.v5)a[o]=Z(s,n,r);else{var l=$("<row>"+s+"</row>");a[o]=Z(l,n,r)}}return a}function ie(e,t,n){return H(j(function(e,t,n){var r=Q(e,t);return r.map((function(r){var i,a=S(r.id);r.value&&(r.type?(i="s"===r.type?n.getSharedStrings()[parseInt(r.value)]:"str"===r.type?R(r.value):C(Number(r.value),{dateFormat:n.getStyles&&n.getStyles()[r.style]?n.getStyles()[r.style]:void 0,dateOrigin:n.dateOrigin}):(i=C(Number(r.value),{dateFormat:n.getStyles&&n.getStyles()[r.style]?n.getStyles()[r.style]:void 0,dateOrigin:n.dateOrigin}))):i=void 0;return{row:a[0],column:a[1],value:i}}))}(e,t,n),e),e)}function ae(e,t,n,r){return n?te(e,r):r.v5?ee(e,r):re(X(e,r).rowStrings,X(e,r).totalRows,r,t)}var oe={getDimensions:function(e,t){if(!e)return[];var n=v(e,"dimension",!0);if(!n)return[];var r=n.getAttribute("ref");if(r.indexOf(":")<0)return[S(r)];var i=r.split(":").map(S);if(t&&t.v5)return i;var a=i[0],o=i[1];return[{row:a[0],column:a[1]},{row:o[0],column:o[1]}]}};function se(e){var t=w(e,"r",!1,!0),n=S(t),r=w(e,"s",!0,!0),i=w(e,"t",!0),a=v(e,"v",!0);return{row:n[0],column:n[1],value:a?a.textContent:void 0,style:r,type:i}}function le(e,t){var n=e.getElementsByTagName("c");if(0===n.length)return[];var r=new Array(n.length);for(var i=0;i<n.length;i++)r[i]=se(n[i]);return r}function ue(e,t,n){if(n.v5){var r=e.getElementsByTagName("row");if(0===r.length)return[];var i=new Array(r.length);for(var a=0;a<r.length;a++){var o=r[a];i[a]=le(o,t)}return i}var s=v(e,"sheetData",!1,!0);if(!s)return[];var l=v(s,"row",!1,!J);if(!l)return[];if(J&&l.length>0){i=new Array(l.length);for(a=0;a<l.length;a++)i[a]=le(l[a],t);return i}var u=v(e,"dimension",!0);if(!u)return[];var c=u.getAttribute("ref").split(":").map(S),f=c[0],p=c[1],h=p[0]-f[0]+1,m=p[1]-f[1]+1;i=new Array(h);for(a=0;a<h;a++)i[a]=new Array(m);return i}var ce="undefined"!=typeof DOMParser;function fe(e){return ce?$(e):new ActiveXObject("Microsoft.XMLDOM")}function pe(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&g").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var he=function(e,t){return Object.keys(t).reduce((function(e,n){return e.replace(new RegExp(n,"g"),t[n])}),e)};function me(e){return String(e).trim()}function ge(e){return String(e).toLowerCase()}function de(e){if(e.indexOf(" ")>=0)return'"'+e+'"';return e}function be(e){return'"'+e.replace(/"/g,'""')+'"'}function ve(e){if(!e)return"";var t,n,r=e.type,i=e.value;if("number"===r)n=String(i);else if("string"===r)n=de(i);else if("date"===r)n=de(i.toISOString());else if("hyperlink"===r)n=de(i.value);else if("formula"===r)n=de(i.value);else{if("boolean"!==r)throw new Error("Unsupported write cell type: "+r);n=String(i)}return t&&t(e)?be(n):n}function ye(e,t,n){var r={sheets:[]};if(!n||"string"!=typeof n.type||"array"!==n.type)throw new Error('Invalid "output" option: "'+JSON.stringify(n)+'"');return function(e,t,n){e.sheets=t.map((function(t){var r={name:t.name};if(n.sheet){if("number"==typeof n.sheet){if(t.id!==n.sheet)return}else if("string"!=typeof n.sheet)throw new Error('Unsupported "sheet" option: '+n.sheet);else if(t.name!==n.sheet)return}return r.cells=function(e,t){var n;n=e.map((function(e){return e.map(ve)})).map((function(e){return e.join(t)})).join("\n");return n}(t.data,e.delimiter),r.cells?r:void 0})).filter(Boolean);return e}(r,t,n),"string"===n.type?r.sheets[0].cells:"array"===n.type?r.sheets.map((function(e){return[e.name,e.cells]})):r}function we(e,t){return t.v5?function(e){var t={};e.forEach((function(e){t[e.path.toLowerCase()]=e.getData()}));return t}(e):function(e){var t={};return e.forEach((function(e,n){t[n.toLowerCase()]=e.asText()})),t}(e,t)}function ke(e,t){return t.v5?function(e,t){return e.filter((function(e){return"application/vnd.openxmlformats-officedocument.relationships+xml"===e.type&&t.substring(t.lastIndexOf("/")+1)===e.path.substring(e.path.lastIndexOf("/")+1)&&(t.substring(0,t.lastIndexOf("/")+1)+"_rels"===e.path.substring(0,e.path.lastIndexOf("/")+1)||t.substring(0,t.lastIndexOf("/")+1)===""&&"_rels"===e.path.substring(0,e.path.lastIndexOf("/")+1))}))[0]}(e,t):e.filter((function(n){return"application/vnd.openxmlformats-officedocument.relationships+xml"===n.type&&t.substring(t.lastIndexOf("/")+1)===n.name.substring(n.name.lastIndexOf("/")+1)&&(t.substring(0,t.lastIndexOf("/")+1)+"_rels"===n.name.substring(0,n.name.lastIndexOf("/")+1)||t.substring(0,t.lastIndexOf("/")+1)===""&&"_rels"===n.name.substring(0,n.name.lastIndexOf("/")+1))}))[0]}function xe(e,t){var n;return t.v5?n=function(e){var t=e.getElementsByTagName("Relationship");return[].map.call(t,(function(e){return{id:e.getAttribute("Id"),type:e.getAttribute("Type").substr("http://schemas.openxmlformats.org/officeDocument/2006/relationships/".length),target:e.getAttribute("Target"),targetMode:e.getAttribute("TargetMode")}))}(e):n=function(e,t){var n=v(e,"Relationships").getElementsByTagName("Relationship");return[].map.call(n,(function(e){return{id:e.getAttribute("Id"),type:e.getAttribute("Type").substr("http://schemas.openxmlformats.org/officeDocument/2006/relationships/".length),target:e.getAttribute("Target"),targetMode:e.getAttribute("TargetMode")}))}(e,t),t.v5?n.map((function(e){return"attachedToolbars"===e.type&&e.targetMode?e:e.targetMode?e:{id:e.id,type:e.type,target:e.target}})):n.map((function(e){return"attachedToolbars"===e.type&&e.targetMode?e:e.targetMode?e:{id:e.id,type:e.type,target:e.target}}))}function Ee(e,t,n){var r={};"number"==typeof t&&(t={sheet:t});var i=t||{};if(i.v5=n,i.sheet){var a=i.sheet;if("number"!=typeof a&&"string"!=typeof a)throw new Error('Using "sheet" option: "sheet" must be a number or a string.');i.sheetNameOrIndex=a}return p(e).then((function(e){return function(e,t,n){if(!t.vFile)return new Error("vFile not supported");if(t.v5){var r=t.vFile.getEntry("xl/workbook.xml");if(!r)throw new Error('File not found: "xl/workbook.xml"');var i=fe(r.getData());return t.getWorkbook=function(){return i},Y.getSheets(null,t)}var a=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"===e.type}))[0];if(!a)throw new Error("Could not find workbook XML file (part name "+t.partName+")");var o=fe(a.asText());return t.getWorkbook=function(){return o},Y.getSheets(null,t)}(e,i,r).then((function(n){if(i.sheet){if("number"==typeof i.sheet){if(i.sheet>n.length)throw new Error("Sheet index "+i.sheet+" is out of bounds. The file has "+n.length+" sheets.")}else if("string"==typeof i.sheet){var a=!1;for(var o=0;o<n.length;o++){if(n[o]===i.sheet){a=!0;break}}if(!a)throw new Error('Sheet "'+i.sheet+'" not found. Available sheets: '+n.map((function(e){return'"'+e+'"'})).join(", "))}var s=function(e,t,n){if(t.v5){var r=t.vFile.getEntry(e);if(!r)throw new Error("File not found: "+e);return fe(r.getData())}var i=t.vFile.filter((function(t){return"application/vnd.openxmlformats-officedocument.spreadsheetml."+n+"+xml"===t.type&&t.name.indexOf(e)>=0}))[0];if(!i)throw new Error("File not found: "+e);return fe(i.asText())};return r.sheets=n,function e(n,r,a){return r.v5?function(e,t){var n=t.vFile.getEntry("xl/_rels/workbook.xml.rels");if(!n)throw new Error('File not found: "xl/_rels/workbook.xml.rels"');var r=fe(n.getData()),i=xe(r,t);t.getRelationships=function(){return i};var a=Y.getSheets(null,t);if("number"!=typeof t.sheet&&"string"!=typeof t.sheet)return a;var o=Y.getSheets(null,t);if("number"==typeof t.sheet&&t.sheet>o.length)throw new Error("Sheet index "+t.sheet+" is out of bounds. The file has "+o.length+" sheets.");var s=Y.getSheets(null,t).filter((function(e){return"number"==typeof t.sheet?e.id===String(t.sheet):e.name===t.sheet}))[0];if(!s)throw new Error("Sheet index "+t.sheet+" not found.");var l=i.filter((function(e){return e.id===s.id}))[0];if(!l)throw new Error('No relationship for sheet ID "'+s.id+'"');return"worksheets"+l.target.substring(l.target.lastIndexOf("/"),l.target.length)}(e,r,a):function(e,t,n){var r=ke(t.vFile,e);if(!r)throw new Error("Could not find relationships XML file for "+e);var i=fe(r.asText()),a=xe(i,t);t.getRelationships=function(){return a};var o=Y.getSheets(null,t);if("number"!=typeof t.sheet&&"string"!=typeof t.sheet)return o;var s=Y.getSheets(null,t).filter((function(e){return"number"==typeof t.sheet?e.id===String(t.sheet):e.name===t.sheet}))[0];if(!s)throw new Error("Sheet index "+t.sheet+" not found.");var l=a.filter((function(e){return e.id===s.id}))[0];if(!l)throw new Error('No relationship for sheet ID "'+s.id+'"');return l.target}(n,r,a).then((function(a){if(i.sheet){var o,l=i.v5?function(e,t){var n=t.vFile.getEntry("xl/sharedStrings.xml");if(n)return fe(n.getData())}(0,i):function(e,t){var n=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"===e.type}))[0];if(n)return fe(n.asText())}(0,i),c=i.v5?function(e,t){var n=t.vFile.getEntry("xl/styles.xml");if(n)return fe(n.getData())}(0,i):function(e,t){var n=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"===e.type}))[0];if(n)return fe(n.asText())}(0,i);l?i.getSharedStrings=function(){return Y.getSharedStrings(null,i)}:i.getSharedStrings=function(){return[]},c?i.getStyles=function(){return Y.getStyles(null,i)}:i.getStyles=function(){return[]},i.v5?o=s("xl/"+a,i,"sheet"):o=s(a,i,"sheet");var f=r.getDimensions?r.getDimensions(o,i):oe.getDimensions(o,i),p=r.getData?r.getData(o,i,r,f):ae(o,f,i.includeSheetDimensions,i);return r.sheets=[{name:"number"==typeof i.sheet?n[i.sheet-1]:i.sheet,data:p}],p}return r.sheets=n.map((function(t){return{name:t}})),e(n,r,a)}))}(Y.getSheets(null,i),i,r)}return r.sheets=n.map((function(e){return{name:e}})),e(n,i,r)}))}))}var Ne={parseData:ae},Oe={parseData:function(e,t,n,r){return ue(e,r,t)}};function Se(e){return p(e).then((function(e){return _e(e,{v5:!0})}))}function _e(e,t){return new m.vFile(e).then((function(e){return function(e,t){if(!t.vFile)return new Error("vFile not supported");t.vFile=e,t.getEntries=function(){return e.files};var n=we(e,t),r=function(e,t){return t.v5?e["[content_types].xml"]:e["[content_types].xml"]}(n,t);if(!r)throw new Error('Could not find "[Content_Types].xml" file in the *.xlsx file.');var i,a=fe(r),o=function(e,t){if(t.v5)return e.getElementsByTagName("Override")[0].getAttribute("PartName");var n=v(e,"Types").getElementsByTagName("Override");return[].filter.call(n,(function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"===e.getAttribute("ContentType")}))[0].getAttribute("PartName")}(a,t);return t.partName=o.substring(1),Ee(null,t,t.v5)}(e,t)}))}function Te(e,t,n){var r={};"number"==typeof t&&(t={sheet:t});var i=t||{};if(i.v5=n,i.sheet){var a=i.sheet;if("number"!=typeof a&&"string"!=typeof a)throw new Error('Using "sheet" option: "sheet" must be a number or a string.');i.sheetNameOrIndex=a}return p(e).then((function(e){return function(e,t,n){if(!t.vFile)return new Error("vFile not supported");if(t.v5){var r=t.vFile.getEntry("xl/workbook.xml");if(!r)throw new Error('File not found: "xl/workbook.xml"');var i=fe(r.getData());return t.getWorkbook=function(){return i},Y.getSheets(null,t)}var a=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"===e.type}))[0];if(!a)throw new Error("Could not find workbook XML file (part name "+t.partName+")");var o=fe(a.asText());return t.getWorkbook=function(){return o},Y.getSheets(null,t)}(e,i,r).then((function(n){if(i.sheet){if("number"==typeof i.sheet){if(i.sheet>n.length)throw new Error("Sheet index "+i.sheet+" is out of bounds. The file has "+n.length+" sheets.")}else if("string"==typeof i.sheet){var a=!1;for(var o=0;o<n.length;o++){if(n[o]===i.sheet){a=!0;break}}if(!a)throw new Error('Sheet "'+i.sheet+'" not found. Available sheets: '+n.map((function(e){return'"'+e+'"'})).join(", "))}var s=function(e,t,n){if(t.v5){var r=t.vFile.getEntry(e);if(!r)throw new Error("File not found: "+e);return fe(r.getData())}var i=t.vFile.filter((function(t){return"application/vnd.openxmlformats-officedocument.spreadsheetml."+n+"+xml"===t.type&&t.name.indexOf(e)>=0}))[0];if(!i)throw new Error("File not found: "+e);return fe(i.asText())};return r.sheets=n,function e(n,r,a){return r.v5?function(e,t){var n=t.vFile.getEntry("xl/_rels/workbook.xml.rels");if(!n)throw new Error('File not found: "xl/_rels/workbook.xml.rels"');var r=fe(n.getData()),i=xe(r,t);t.getRelationships=function(){return i};var a=Y.getSheets(null,t);if("number"!=typeof t.sheet&&"string"!=typeof t.sheet)return a;var o=Y.getSheets(null,t);if("number"==typeof t.sheet&&t.sheet>o.length)throw new Error("Sheet index "+t.sheet+" is out of bounds. The file has "+o.length+" sheets.");var s=Y.getSheets(null,t).filter((function(e){return"number"==typeof t.sheet?e.id===String(t.sheet):e.name===t.sheet}))[0];if(!s)throw new Error("Sheet index "+t.sheet+" not found.");var l=i.filter((function(e){return e.id===s.id}))[0];if(!l)throw new Error('No relationship for sheet ID "'+s.id+'"');return"worksheets"+l.target.substring(l.target.lastIndexOf("/"),l.target.length)}(e,r,a):function(e,t,n){var r=ke(t.vFile,e);if(!r)throw new Error("Could not find relationships XML file for "+e);var i=fe(r.asText()),a=xe(i,t);t.getRelationships=function(){return a};var o=Y.getSheets(null,t);if("number"!=typeof t.sheet&&"string"!=typeof t.sheet)return o;var s=Y.getSheets(null,t).filter((function(e){return"number"==typeof t.sheet?e.id===String(t.sheet):e.name===t.sheet}))[0];if(!s)throw new Error("Sheet index "+t.sheet+" not found.");var l=a.filter((function(e){return e.id===s.id}))[0];if(!l)throw new Error('No relationship for sheet ID "'+s.id+'"');return l.target}(n,r,a).then((function(a){if(i.sheet){var o,l=i.v5?function(e,t){var n=t.vFile.getEntry("xl/sharedStrings.xml");if(n)return fe(n.getData())}(0,i):function(e,t){var n=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"===e.type}))[0];if(n)return fe(n.asText())}(0,i),c=i.v5?function(e,t){var n=t.vFile.getEntry("xl/styles.xml");if(n)return fe(n.getData())}(0,i):function(e,t){var n=t.vFile.filter((function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"===e.type}))[0];if(n)return fe(n.asText())}(0,i);l?i.getSharedStrings=function(){return Y.getSharedStrings(null,i)}:i.getSharedStrings=function(){return[]},c?i.getStyles=function(){return Y.getStyles(null,i)}:i.getStyles=function(){return[]},i.v5?o=s("xl/"+a,i,"sheet"):o=s(a,i,"sheet");var f=r.getDimensions?r.getDimensions(o,i):oe.getDimensions(o,i),p=r.parseData?r.parseData(o,f,i,r):Ne.parseData(o,f,i,r);return r.sheets=[{name:"number"==typeof i.sheet?n[i.sheet-1]:i.sheet,data:p}],p}return r.sheets=n.map((function(t){return{name:t}})),e(n,r,a)}))}(Y.getSheets(null,i),i,r)}return r.sheets=n.map((function(e){return{name:e}})),e(n,i,r)}))}))}function Ce(e,t){if("http://www.w3.org/2000/09/xmldsig#"===e.namespaceURI&&"Signature"===e.localName)return!0;if("http://schemas.microsoft.com/office/2006/key-value"===e.namespaceURI)return!0;for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType&&!Ce(r))return!1}return!0}var Ie={getSheets:function(e,t){return W.getSheets(e.getElementsByTagName("workbook")[0],t)},getSharedStrings:function(e,t){return W.getSharedStrings(e.getElementsByTagName("sst")[0],t)},getStyles:function(e,t){return W.getStyles(e.getElementsByTagName("styleSheet")[0],t)},getDimensions:oe.getDimensions,parseData:function(e,t,n,r){return ue(e,r,t)}};function Re(e,t){return Te(e,t,Ie)}function Ae(e,t,n){return e=d(e),n.v5?Ee(t,h(e,n),!0):Re(t,h(e,n))}function Le(e){return r(e)?e.trim():String(e)}var Me=["#NULL!","#DIV/0!","#VALUE!","#REF!","#NAME?","#NUM!","#N/A","#GETTING_DATA"];function qe(e,t){var n,r;o(t)&&(n=t.props.children,r=t.value),o(e)&&(e=e.value);var i=String(e);return n&&i&&(i=function(e,t,n,r){var i,a=[],o=!0;i="string"==typeof t?t.split(""):t;for(var s=0;s<i.length;s++){var l=i[s];if(o){o=!1;var u="string"==typeof l?l.trim():l;"R"===u?(a.push({type:"text",value:e}),r&&i.length>1&&a.push({type:"text",value:" "})):"r"===u?a.push({type:"text",value:e}):"T"===u?a.push({type:"text",value:e.trim()}):"t"===u?a.push({type:"text",value:e.trim()}):a.push(l)}else"r"===l||"R"===l||"t"===l||"T"===l?o=!0:a.push(l)}var c=[];for(s=0;s<a.length;s++){var f=a[s];if(o(f)){var p=f.props,h=p.children;if(Array.isArray(h)&&0===h.length)c.push({type:"text",value:f.value,font:p.font});else if(p&&p.style){var m=p.style,g={type:"text",value:f.value};if(m.font){var d={};m.font.bold&&g.font.push("bold"),m.font.italic&&g.font.push("italic"),m.font.underline&&g.font.push("underline"),m.font.color&&(g.color=m.font.color),m.font.name&&(g.fontName=m.font.name),m.font.size&&(g.fontSize=m.font.size),g.font=d}if(m.color)g.color=m.color;"subscript"===m.verticalAlign?g.verticalAlign="subscript":"superscript"===m.verticalAlign&&(g.verticalAlign="superscript"),c.push(g)}else c.push({type:"text",value:f.value})}else c.push(f)}"t"===n&&(c=c.map((function(e){return"text"===e.type?{type:"text",value:e.value.trim()}:e})));var b="";for(s=0;s<c.length;s++)b+=c[s].value;return b}(e,n,r)),i.replace(/_x000D_/g,"\r").replace(/_x000A_/g,"\n").replace(/_x0009_/g,"\t")}function Be(e,t,n){return"b"===t?Boolean(Number(e)):("s"===t?n.sharedStrings[Number(e)]:("str"===t?qe(e):(e?C(Number(e),{dateFormat:n.styles&&n.styles[n.style]?n.styles[n.style]:void 0,dateOrigin:n.dateOrigin}):void 0))||null}function Fe(e,t){var n=v(e,"sheetData",!1,!0);if(!n)return[];var i=n.getElementsByTagName("row");if(0===i.length)return[];var a=new Array(i.length);for(var o=0;o<i.length;o++){var s=i[o],l=le(s,t),u=E(w(s,"r",!1,!0));a[o-1]=new Array(l.length);for(var c=0;c<l.length;c++){var f=l[c];f.value&&Me.indexOf(f.value)>=0&&(f.value=void 0),a[u-1][f.column-1]=f.value?Be(f.value,f.type,{sharedStrings:t.sharedStrings,styles:t.styles,style:f.style,dateOrigin:t.dateOrigin}):null}}return a}var Pe={getDimensions:oe.getDimensions,parseData:Fe};function Ve(e,t){return Te(e,t,Pe)}function je(e,t){return p(e).then((function(e){return _e(e,{v5:!0})}))}var He=Object.freeze({__proto__:null,parseSheet:Ae,readSheetNames:Ee,default:Re,v5:Se,_parseSheet:Te,v5parseSheet:Se,_readSheetNames:_e,parseSheetNames:function(e,t){return t&&t.v5?_e(e,{v5:!0}):Ee(e,t)},readCell:function(e,t){var n,r;o(t)&&(n=t.props.children,r=t.value),o(e)&&(e=e.value);var i=String(e);return n&&i&&(i=function(e,t,n,r){var i,a=[],o=!0;i="string"==typeof t?t.split(""):t;for(var s=0;s<i.length;s++){var l=i[s];if(o){o=!1;var u="string"==typeof l?l.trim():l;"R"===u?(a.push({type:"text",value:e}),r&&i.length>1&&a.push({type:"text",value:" "})):"r"===u?a.push({type:"text",value:e}):"T"===u?a.push({type:"text",value:e.trim()}):"t"===u?a.push({type:"text",value:e.trim()}):a.push(l)}else"r"===l||"R"===l||"t"===l||"T"===l?o=!0:a.push(l)}var c=[];for(s=0;s<a.length;s++){var f=a[s];if(o(f)){var p=f.props,h=p.children;if(Array.isArray(h)&&0===h.length)c.push({type:"text",value:f.value,font:p.font});else if(p&&p.style){var m=p.style,g={type:"text",value:f.value};if(m.font){var d={};m.font.bold&&g.font.push("bold"),m.font.italic&&g.font.push("italic"),m.font.underline&&g.font.push("underline"),m.font.color&&(g.color=m.font.color),m.font.name&&(g.fontName=m.font.name),m.font.size&&(g.fontSize=m.font.size),g.font=d}if(m.color)g.color=m.color;"subscript"===m.verticalAlign?g.verticalAlign="subscript":"superscript"===m.verticalAlign&&(g.verticalAlign="superscript"),c.push(g)}else c.push({type:"text",value:f.value})}else c.push(f)}"t"===n&&(c=c.map((function(e){return"text"===e.type?{type:"text",value:e.value.trim()}:e})));var b="";for(s=0;s<c.length;s++)b+=c[s].value;return b}(e,n,r)),i.replace(/_x000D_/g,"\r").replace(/_x000A_/g,"\n").replace(/_x0009_/g,"\t")},getDimension:function(e,t){return oe.getDimensions(e,t)},parseCells:Z,parseCell:J,getCells:le,parseDimensions:function(e,t){var n=oe.getDimensions(e,t);if(n&&n.length>0)return n},getRows:ue,getMergedCells:function(e,t){if(!t.getElementsByTagName)return e.map((function(t){return e.map((function(e){return[e[0],O(e[1]),e[2]]}))}));var n=v(e,"mergeCells",!0);if(!n)return[];var r=n.getElementsByTagName("mergeCell");if(0===r.length)return[];for(var i=[],a=0;a<r.length;a++){var o=r[a].getAttribute("ref");if(o.indexOf(":")<0)throw new Error('Invalid merged region value: "'+o+'"');i.push(o.split(":").map(S))}return i},applyMergedCells:j,groupCells:H,xml:fe,noop:function(){},getStyleId:function(e){return w(e,"s",!0,!0)},getValue:function(e){return v(e,"v",!0)},getCellType:function(e){return w(e,"t",!0)},NULL_CELL:void 0,Number:C,Template:A,formatCell:qe,parseValue:Be,parseDate:function(e,t,n){void 0===n&&(n=new Date(1899,11,30));if(e<0)return"#VALUE!";var r=Math.floor(e);e-=r;var i=new Date(n.getTime()+(r-1)*864e5+e*864e5+function(e,t){var n=Math.round(e);return(t.getTime()-n.getTime())/(1e3*60)}(n,new Date(n.getTime()+(r-1)*864e5+e*864e5)));return function(e,t){void 0===t&&(t="MM/DD/YY");var n=I(t);if(n){t=n;var r=I(t);if(r)throw new Error("Using a built-in date format as a default one is not supported: "+r+". To work around this issue, use a custom date format: "+t.replace(r,F(r)))}return t=t.replace(/\[\$.+?\]/g,""),t=L(t),t=M(t,i),A(t,i)}(t||"MM/DD/YY"),e},getTemplate:I,isDateTemplate:function(e){return 14===e||15===e||16===e||17===e||18===e||19===e||20===e||21===e||22===e||45===e||46===e||47===e},getBuiltInTemplates:function(){return B},parseProperties:P,readXlsxFile:Ve,readXlsxFileContents:je,writeXlsxFile:function(e,t){return ye(e,t,{type:"string"})},writeXlsxFileBuffer:function(e,t){return ye(e,t,{type:"array"})},writeXlsxFileStream:function(){throw new Error("Not implemented")},trim:Le,ERROR_MESSAGES:Me});return function(e,t){var n;t&&t.v5&&(n=t.v5);t&&t.v5?Ee(e,t,n):Re(e,t);return Ee(e,t,n)}}));
