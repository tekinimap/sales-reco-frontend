!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Papa={})}(this,(function(e){"use strict";var t=e.BAD_DELIMITERS="Delimiter must be a single character other than a double-quote",n=e.INVALID_OPENING_QUOTES="A double-quote character must be escaped to be inside fields",r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},i="undefined"!==("undefined"!=typeof r&&r.document)&&r.document.documentMode;function a(e){if("string"!=typeof e)throw new Error("Input must be a string");var t=e.trim();return"true"===t||"1"===t||"yes"===t||"y"===t||(t=t.toLowerCase(),"false"!==t&&"0"!==t&&"no"!==t&&"n"!==t&&void 0)}var o=e.RECORD_SEP="\r\n",s=e.UNIT_SEP="\u001f",l=e.WARNING="Warning",c=e.ERROR="Error";function u(e){var t=e.split(o);if(t.length>1&&""===t[t.length-1]&&t.pop(),e.endsWith(o))return t.join(o)+o;return t.join(o)}var d=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)};function f(){return"undefined"!=typeof process&&process.versions&&process.versions.node}var h=Object.prototype.hasOwnProperty,g=function(){function e(e){this.file=e,this.options=e.options,this.parser=e.parser,this.firstChunk=!0,this.unprocessed=""}return e.prototype.stream=function(){return this.file},e.prototype.parseChunk=function(e,t){this.firstChunk&&(this.firstChunk=!1),this.unprocessed+=e;var n=this.parser.parse(this.unprocessed,this.options);if(t)return this.chunk(n,"");var r=n.meta&&n.meta.cursor||0;n.data&&(this.unprocessed="string"==typeof e?e.substring(r):""),this.chunk(n)},e.prototype.chunk=function(e,t){this.file.chunk(e,t)},e}(),m=function(){function e(e){e=e||{},this.options=p(e),this.options.chunkSize=parseInt(this.options.chunkSize)}return e.prototype.parse=function(e,t){var n=this;function r(e){var t=n.options.chunkSize||0;t>0?n.streamer.parseChunk(e,t>=e.length):(n.streamer.chunk(n.parser.parse(e,n.options),void 0),n.streamer.finished())}var i=this.options.chunkSize>0,a=e instanceofFile;i||t||(t={chunk:function(){},meta:{}}),this.parser=new v,this.streamer=new b({parser:this.parser,options:this.options,streamer:t}),t.pause=function(){n.streamer.pause(),t.paused=!0},t.resume=function(){n.streamer.resume(),t.paused=!1},t.abort=function(){n.streamer.abort(),t.aborted=!0},i?(this.streamer.parseChunk=function(e,t){var r=n.streamer.unprocessed;n.streamer.unprocessed+=e;var i=n.streamer.unprocessed,a=n.options.chunkSize-r.length;n.streamer.unprocessed.length>1e6?t(i.length-a):t(i.substring(0,i.length-a))},a?new y(this.options).read(e,t.chunk,function(e){n.streamer.finished(),t.chunk(n.parser.parse(n.streamer.unprocessed,n.options),t)},t.error):r(e)):a?new y(this.options).read(e,function(e){r(e)},function(e){r(""),t.chunk(n.parser.parse(n.streamer.unprocessed,n.options),t),n.streamer.finished()},t.error):r(e)},e}();function p(e){var t={delimiter:"",newline:"",quoteChar:!1,escapeChar:!1,header:!1,trimHeaders:!1,dynamicTyping:!1,preview:0,encoding:"",worker:!1,comments:!1,step:void 0,complete:void 0,error:void 0,skipEmptyLines:!1,fastMode:!1,beforeFirstChunk:void 0,withCredentials:!1,chunk:void 0,chunkSize:void 0};return Object.keys(t).forEach((function(n){t[n]=h.call(e,n)?e[n]:t[n]})),h.call(e,"delimiter")||","!==e.delimiter&&";"!==e.delimiter?h.call(e,"newline")||(t.newline=p.newline):t.newline=o,t}p.newline="",p.delimiter=",",p.RECORD_SEP=o,p.UNIT_SEP=s;var v=function(){function e(){this.parsedData=""}return e.prototype.parse=function(e,t,n){if(!t.delimiter&&!t.fastMode){var r=new w(e,t,n);return{data:r.data,errors:r.errors,meta:r.meta}}if(t.newline||(t.newline=p.newline),t.delimiter.length>1&&!t.fastMode)throw new Error(t.delimiter.length>1?v.BAD_DELIMITER:"");if(t.quoteChar.length>1)throw new Error("quoteChar must be a single character");if(t.escapeChar.length>1)throw new Error("escapeChar must be a single character");var i=0,a=!1;if(e.constructor!==String&&(e=String(e)),e=u(e),!e)return{data:[],errors:[],meta:{delimiter:t.delimiter,break:!1,aborted:!1,truncated:!1,cursor:0,bytes:0}};var o=t.comments,s=t.step,l=t.preview,c=t.fastMode,d=t.skipEmptyLines,f=t.header,h=t.trimHeaders,g=t.dynamicTyping,m=t.encoding,y=t.worker,b=t.quoteChar,S=t.escapeChar,E=t.newline,C=t.delimiter,k="string"==typeof b&&b,x="string"==typeof S&&S,L=E.length,T=C.length,R="function"==typeof s,A=!R&&"function"==typeof t.chunk,P=t.complete,O="function"==typeof t.error?t.error:v.DefaultErrorFn,F="function"==typeof t.beforeFirstChunk?t.beforeFirstChunk:void 0,D=t.transform,M=!1,q=t.transformHeader,N=!1;if(!y&&(F&&F(e,m),e=this.parsedData+e,this.parsedData=""),"string"!=typeof o)if("boolean"===o&&o)o=v.DefaultComments;else if("function"!=typeof o)o=!1;var j,U,H,B,I,K,J,G,W,z,Q,X,Y,Z,$,ee,te,ne,re,ie,ae,oe=0,se=0,le=[],ce=[],ue=[],de={},fe=0,he=0,ge=!1,me=!0,pe=!1,ve=!1;function ye(){if(ge)return;J&&J.abort(),ge=!0,me=!1,"function"==typeof O&&O({type:c,code:"Abort",message:"Parse aborted"})}function be(e,t,n){ce.push({type:l,code:"Quotes",message:e,row:n,index:t})}function Se(e,t,n,r){ce.push({type:c,code:e,message:t,row:n,index:r})}function Ee(e,t,n){e=e.substr(0,e.length-L);for(var r=t;r<n;r++)Ce(e[r],r);xe()}function Ce(e,t){if(pe)re=re+e;else if(me&&(J&&!J.paused||!J))if(f&&0===fe){if(!ne&&(ne={}),W&&(h?ne[e]=fe:ne[e.trim()]=fe,Q=e),W&&he>0){if(ne[Q]){if(ce.length>0&&ce[ce.length-1].code!=="DuplicateHeader")Se("DuplicateHeader","Duplicate header '"+Q+"'",fe);ne[Q]=void 0,h||(W=W.trim()),delete ne[W]}Q=""}else Q=e;if(e===C)he++,G=t,re="";else if(e===b)W=Q,Q="",H=!k;else if(e===E){if(!k||Q!==b)return he++,void xe();k&&Q===b&&(Q="")}else Q===b&&e!==b&&(H=!k);W&&h&&(W=W.trim()),W&&ne[W]=void 0,W=""}else if(f||g)if(G=t,e===C)U=!1,k||g?(k&&H&&(B=!0,H=!1),Ce(e)):void 0;else if(e===b){if(U)return pe=!0,void(re=e);U=!0}else e===E?(pe?pe=!1:(U&&re===b||!U)&&xe(),U=!1,G=void 0):U?re+=e:(me=Ce(e,t),G=void 0);else if(e===C)G=t,Ce(e);else if(e===E)xe(),G=void 0;else if(e===b){if(K)return void Se("Quote",n,fe,t);K=!0,G=t,I=t}else{if(K&&!c)return void Se("InvalidQuotes","Unexpected character after quoted field",fe,t);Ce(e,t),G=void 0}return!0}function ke(e,t){if(re)if(f||g)if(B)re=b+re,B=!1;else if(!f&&g){var n;try{n=JSON.parse(re)}catch(e){}void 0!==n?re=n:a(re)&&(re=a(re)),B=!1}else f&&(B=!1);ie&&ie.push(re),re=""}function xe(){if(me=!0,he++,ke(),X||(Y.push(ie),Y.length>v.MaxPredictionRows&&(X=!0)),f&&!N&&ie.length!==he)Se("RowLength",v.UnevenRowsMessage,fe);else if(d&&0==ie.length||1==ie.length&&""===ie[0])d&&ue.push(ie[0]);else{if(R)try{s(Z=Le(ie),J)}catch(e){O(e,Z),ge=!0}A?(J.chunk(Z=Le(ie),J),J.paused&&ye()):(R||(ve?Te():(ne=Le(ie),ve=!0)),Z=Le(ie))}return!M&&(M=X||M||Y&&Y.length>=v.MaxPredictionRows),ie=[],he=0}function Le(e){if(!f)return e;!N&&(N=!0,function(e){if(e.length!==he)return void Se("HeaderMismatch",v.UnevenRowsMessage,1);if(h)for(var t=0;t<e.length;t++)e[t]=e[t].trim();ne=e}(e));var t={};for(var n=0;n<e.length;n++)n<ne.length?t[ne[n]]=e[n]:t[v.DefaultHeader]=""==e[n]?void 0:e[n];return t}function Te(){if("function"==typeof q)for(var e=0;e<ne.length;e++)ne[e]=q(ne[e],e);N=!0}if(R||A||P)J={abort:ye,pause:function(){me=!1,J.paused=!0},resume:function(){me=!0,J.paused=!1,Ee(Z,$,ee)},chunk:function(e,t){if(A&&e){if(f&&!N)Te();le.push(e)}R||A||P||(J=void 0)},push:function(e){le.push(e)},read:function(){return le.shift()},getErrors:function(){return ce},getCharIndex:function(){return t}},void 0===l||l<=0?l=!1:X=!0;else{if(X=!0,void 0===l||l<=0)l=!1;else if("number"==typeof l)l=parseInt(l);else{if("boolean"!=typeof l)throw new Error("Preview must be a number or boolean");l=v.DefaultPreview}}if(k){var Re=""+C+E+b;x&&(Re+=S)}if(M)Y=void 0;else if(k||f||g)Y=[];if(c){for($=0;$<e.length;$++){var Ae=e[$];if(R)if(ge)return Oe();if($>0&&!M&&Y.length>0&&Y.length%100==0)if(X||(M=De(Y,C,E,b,S)))return Oe(t.preview);if(Ae===b){if(K)K=!1;else{K=!0,I=$}re+=Ae}else Ae===C&&!K?ke():Ae===E?K?(re+=Ae,be("Line break in quoted field",$-L+1,fe)):(ke(),xe(),l&&fe>=l&&me&&ye()):K||(re+=Ae)}ke(),xe()}else{var Pe,Oe=function(n){if(A)J.chunk(le,J);else if(R||P)if(P){var r={data:le,errors:ce,meta:Fe()};if(n&&(r.data=r.data.slice(0,l)),"function"==typeof P)try{P(r,J)}catch(e){O(e)}}else{if(!ve)throw"Cannot use step function without header row";Te()}return ge?J:void 0},Fe=function(){return{delimiter:t.delimiter,linebreak:t.newline,header:f,fields:f?ne:void 0,truncated:l>0,aborted:ge,cursor:$,bytes:i}},De=function(e,t,n,r,i){var a,o,s,l=e.length,u=0,c=0,d=0;for(a=0;a<l;a++){var f=(s=e[a]).length;c+=f,u+=f-s.join("").length,d+=s.filter((function(e){return e.indexOf(r)>=0})).length*r.length*2}return o=c/l,(r?d:u)/l>o?r:i&&i!==r&&(i?d:u)/l>o?i:(t?t.length:0)>(n?n.length:0)?t:n},Me=function(e,t,n){var r,i,a,o,s=0,l=0,c=!1,u=e.indexOf(t,l);-1===u&&(u=e.length);for(;;){if(c=!c,c||n)for(r=l;r<u;r++)a=e[r],o=s,s=","===a?o+1:o,K="\""===a?K+1:K,W=a,ie.push(W);if(c||!n)if(l=u+t.length,u=e.indexOf(t,l),-1===u)break;if(!c||n)if(u=e.length,K%2==0)Ee(e,l,u);else{for(r=l-t.length;r<u;r++)a=e[r],o=s,s=","===a?o+1:o,K="\""===a?K+1:K,W=a,ie.push(W);Ee(e,l,u)}}};Pe=function(e,t,n,r){for(var i=t,a=t,o=0,s=0,l=e.length,c=!1,u="";i<l;){var d=e[i];if(c){if(d===n){if(e[i+1]===n)re+=n,i++;else{if(e[i+1]!==r&&i+1<l)return void Se("Quote",N,fe,i);c=!1}}else re+=d}else d===n?c=!0:d===r?(a=i,ke(),i===t||"\n"===e[i-1]||"\r"===e[i-1]?xe():i++,a=i,t=i,re=""):d==="\n"||d==="\r"?(a=i,ke(),xe(),a=i,t=i,re=""):re+=d;i++}ke(),xe()},function(e,t){for(var n,r,i,a=e.length,o=0,s="",l=!1,c=!1,u=!1,d=0;o<a;){var f=e[o];if(f===b)l?(o+1<a&&e[o+1]===b?(s+=b,o++):l=!1):s.length>0?(be("Unexpected quote",o,fe),s=""):l=!0;else if(f===C&&!l)n=o,ke(),s="",d=0;else if(f===E&&!l){if(r=o,n=o,ke(),s="",d=0,xe(),l&&fe>=l&&me&&ye(),ge)return Oe();o+L>a&&(f=e[o+=L-1])}else l?s+=f:(f===E[0]&&(i=e.substr(o,L))===E?(r=o,n=o,ke(),s="",d=0,xe(),l&&fe>=l&&me&&ye(),ge?Oe():(o+=L-1,f=e[o])):(s+=f,o>r&&(u=!0)),c=!0);o++}return ge?Oe():(n=o,ke(),s="",d=0,xe(),Oe())}(e)}return Oe()}var w=function(){function e(e,t,n){this.options=t,this.options.delimiter||(this.options.delimiter=p.delimiter),this.options.newline||(this.options.newline=p.newline),this.data=[],this.errors=[],this.meta={break:!1,aborted:!1,delimiter:this.options.delimiter,truncated:!1,cursor:0},this.parse(e)}return e.prototype.parse=function(e){var t,n,r,i,a,o,s=this.options,l=s.delimiter,c=s.newline,u=s.quoteChar,d=s.escapeChar,f=s.header,h=s.trimHeaders,g=s.dynamicTyping,m=s.skipEmptyLines,y=s.comments,b=s.preview,S=s.fastMode,E=s.transform,C=s.transformHeader,k=u===d,x=c.length,L=l.length,T=u.length,R=d.length;function A(e){if("function"==typeof C)return C(e);if(h)return e.trim();return e}function P(e){if(g){var t=e.trim();"true"===t||"1"===t?e=!0:"false"===t||"0"===t?e=!1:e=p.toNumber(t)}if("function"==typeof E)return E(e);return e}function O(e){O.string+=e,O.cursor+=e.length}O.string="",O.cursor=0,O.lastRow=null,O.NI=c[0],O.NC=c[c.length-1],O.DI=l[0],O.DC=l[l.length-1],O.QI=u[0],O.QC=u[u.length-1],O.EI=d[0],O.EC=d[d.length-1],O.Comment=y;var F=O.Comment?p.guessComment(e,y):"",D="function"==typeof s.error?s.error:p.DefaultErrorFn,M=e.length,q=0,N=0,j=0,U=0,H={},B=b>0;e=p.stripBOM(e);var I=!1;for(A(r=f?[]:H),a=[];q<M;){if(I)break;if(r=[],j=N,F&&e.substr(q,F.length)===F){if(q+=F.length,F=O.Comment?p.guessComment(e,y,q):"",q>=M)break;if("\n"===e[q]||"\r"===e[q]){if(N++,q++,F=O.Comment?p.guessComment(e,y,q):"",m&&0==r.length)continue;if(B&&N-1>=b)break;if(a.push(r),r=[],m&&0==r.length)continue}}if(S||T>0&&e[q]!==O.QI)if(S&&T>0&&e[q]===O.QI)o=e[q],q++,O(o);else{if(i=e.indexOf(l,q),-1===i)i=M;if(c){var K=e.indexOf(c,q);-1!==K&&K<i&&(i=K)}t=e.substring(q,i),q=i,S?a.push([P(t)]):O(t)}else{if(o=e[q],q++,O(o),n=!0,i=e.indexOf(u,q),-1===i)return w(p.ERROR,"Quotes","Missing closing quote",N,U),e=e.substring(0,e.length-o.length),A(r),a;if(k)for(;(i=e.indexOf(u,q))>-1;){if(O(e.substring(q,i)),q=i,e[q+1]!==u){n=!1;break}O(u),q+=2}else for(;(i=e.indexOf(u,q))>-1;){if(O(e.substring(q,i)),q=i,e[q+1]===u){O(u),q+=2;continue}if(e[q-1]===d){q--;continue}n=!1;break}if(n)return w(p.ERROR,"Quotes","Missing closing quote",N,U),e=e.substring(0,e.length-o.length),A(r),a;t=O.string,O.string="",q++}if(f&&0===N)r.push(A(t));else if(g&&0===r.length&&t===F)r.push(P(t));else if(0===r.length&&t!==F)r.push(P(t));else{var J=P(t);r.push(J)}if(q<M&&e[q]===O.DI&&(q+=L,O(l)),q>=M||e[q]===O.NI||e[q]===O.NC){if(m&&0==r.length)continue;if(B&&N>=b)break;A(r),N++,r=[],m&&0==r.length||(U=q)}}return A(r),m&&0==r.length||a.push(r),{data:a,errors:this.errors,meta:this.meta};function w(e,t,n,r,i){var a={type:e,code:t,message:n,row:r};null!=i&&(a.index=i),this.errors.push(a)}function z(e){var t={};for(var n=0;n<e.length;n++)t[e[n]]=e[n];return t}function Q(e){if(g)for(var t=0;t<e.length;t++){var n=e[t];if(1==n.length){var r=n[0];"true"===r||"1"===r?n[0]=!0:"false"===r||"0"===r?n[0]=!1:n[0]=p.toNumber(r)}else for(var i=0;i<n.length;i++)n[i]=p.toNumber(n[i])}if("function"==typeof E)for(t=0;t<e.length;t++)e[t]=E(e[t],t);return e}function X(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.length!==t)return w(p.ERROR,"RowLength","Uneven number of fields in line",n),!1;if(f){var i=Object.keys(H).length;if(0===n)for(var a=0;a<r.length;a++){var o=r[a];if(null!=H[o])return w(p.ERROR,"DuplicateHeader","Duplicate header: "+o,n),!1;H[o]=o}else{var s={};for(a=0;a<r.length;a++)s[H[Object.keys(H)[a]]]=r[a];e[n]=s}}}return!0}function Y(e,t){if(!f)return e;var n,r={};for(n in t)r[n]=e[n];return r}function Z(e,t){var n,r,i,a,o=[];if(f)for(i=0;i<e.length;i++){for(r={},n=0;n<t.length;n++)r[t[n]]=e[i][n];o.push(r)}else for(a=0;a<e.length;a++)o.push(e[a]);return o}function $(e){if(f){var t,n=[];for(t in e)n.push(t);return n}var r,i,a,o=[];if(e&&e.length>0){for(r=0;r<e.length;r++)for(i=0;i<e[r].length;i++)a=t?t(e[r][i],r,i):e[r][i],o.push(a);return o}return o}function ee(e,t){var n,r,i,a,o={};if(f){for(i=0;i<e.length;i++){for(n in a=Y(o,t.fields||{}),r=e[i])n=t.transformHeader?t.transformHeader(n):n,a[n]=r;o=a}return a}for(i=0;i<e.length;i++){for(n in a={},r=e[i])a[n]=r;o[i]=a}return o}function te(e,t){var n;if("function"==typeof e&&(e=$(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0])){var r,i,a;if(t){var o=[];if("function"==typeof t)o=t(e);else if(Array.isArray(t))for(r=0;r<e.length;r++)o[r]={},i=t[r]?t[r]:t[t.length-1],a=Math.min(e[r].length,i.length),o[r]=re(e[r],a,i);return o}return Z(e)}if(d(e)){var s,l,c;if(t){var u={};if(Array.isArray(t)){for(s=0;s<t.length;s++)l=t[s],u[l]=e[l]?e[l]:void 0;return u}if("function"==typeof t){var h,g,m={};for(h in e)g=t(h,e[h]),m[g]=e[h];return m}var p={};for(l in c=t)p[c[l]]=e[l];return p}return ee(e,t)}throw"Invalid input"}function ne(e){return"number"==typeof e&&!isNaN(e)}p.toNumber=function(e){var t=parseFloat(e);return ne(t)?t:e},e.BAD_DELIMITER=v.BAD_DELIMITER,e.DefaultComments=v.DefaultComments,e.DefaultDelimiter=v.DefaultDelimiter,e.DefaultHeader=v.DefaultHeader,e.DefaultPreview=v.DefaultPreview,e.ERROR=c,e.INVALID_OPENING_QUOTES=v.INVALID_OPENING_QUOTES,e.LocalChunkSize=v.LocalChunkSize,e.MaxPredictionRows=v.MaxPredictionRows,e.NODE_STREAM_INPUT=v.NODE_STREAM_INPUT,e.Parser=v,e.ParserHandle=v.ParserHandle,e.RECORD_SEP=p.RECORD_SEP,e.RemoteChunkSize=v.RemoteChunkSize,e.UNIT_SEP=p.UNIT_SEP,e.UnevenRowsMessage=v.UnevenRowsMessage,e.WARNING=l,e.endsWith=v.endsWith,e.isA=v.isA,e.isFunction=v.isFunction,e.isObject=v.isObject,e.ltrim=v.ltrim,e.parse=v.parse,e.read=v.read,e.readString=v.readString,e.rtrim=v.rtrim,e.unparse=v.unparse;var re=function(e,t,n){for(var r={},i=0;i<t;i++)r[n[i]]=e[i];return r};Object.defineProperty(e,"__esModule",{value:!0})}));
