<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Reconciliation Tool</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body>

    <header>
        <h1>Sales Reconciliation Tool</h1>
        <p>Gleiche Airtable-Exporte (mit Projektnummer) mit ERP-Auszügen ab.</p>
    </header>

    <main>
        <div class="card" id="upload-card">
            <h2>1. Dateien hochladen</h2>
            <p>Bitte lade beide Exporte hoch (inkl. der neuen Airtable-Datei mit Projektnummern).</p>

            <div class="file-input-group">
                <label for="airtable-file">Airtable-Export (Airtable_102025.csv)</label>
                <input type="file" id="airtable-file" accept=".csv">
            </div>

            <div class="file-input-group">
                <label for="erp-file">ERP-Export (.csv oder .xlsx)</label>
                <input type="file" id="erp-file" accept=".csv,.xlsx">
            </div>

            <button id="report-button">Abgleich & Berichte generieren</button>
            <div id="loader" class="loader" style="display: none;"></div>
            <div id="error-message" class="error"></div>
        </div>

        <div class="card" id="reconciliation-report-card" style="display: none;">
            <h2>2. Abgleichs-Bericht (To-Do-Listen)</h2>
            <p>Hier ist die detaillierte Übersicht basierend auf der <strong>Projektnummer</strong>.</p>

            <div id="reco-report-totals"></div>
            <div id="reco-report-projectsToUpdate"></div>        <div id="reco-report-unmatchedERP-byProject"></div>  <div id="reco-report-unmatchedAirtable-byProject"></div> <div id="reco-report-unmatchedERP-byKV"></div>          <div id="reco-report-unmatchedAirtable-noProj"></div>   </div>

        <div class="card" id="final-report-card" style="display: none;">
            <h2>3. Finale Berichte</h2>
            <p>Basierend auf dem Projektnummer-Abgleich sind hier die finalen Erfolgs-Reportings (Beträge vom ERP, Prozente von Airtable).</p>

            <h3>Team-Sales-Erfolg</h3>
            <div id="team-report-area"></div>

            <h3>Personen-Sales-Erfolg</h3>
            <div id="person-report-area"></div>
        </div>
    </main>

    <script src="vendor/papaparse.min.js" defer></script>
    <script src="vendor/read-excel-file.min.js" defer></script>
    <script src="script.js" defer></script> </body>
</html>
